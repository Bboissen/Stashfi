name: Helm Chart Validation

on:
  push:
    branches: [ main, "feat/**", "fix/**", "hotfix/**", "refactor/**", "chore/**" ]
    paths:
      - 'infra/helm/**'
      - '.github/workflows/helm-validation.yml'
      - '.github/workflows/_reusable-helm-validate.yml'
  pull_request:
    branches: [ main ]
    paths:
      - 'infra/helm/**'
      - '.github/workflows/helm-validation.yml'
      - '.github/workflows/_reusable-helm-validate.yml'
  workflow_dispatch:

permissions:
  contents: read
  security-events: write

jobs:
  validate-kong:
    name: Validate Kong Chart
    uses: ./.github/workflows/_reusable-helm-validate.yml
    with:
      chart_path: ./infra/helm/kong
      helm_version: '3.18.6'
      kubernetes_version: '1.31.3'
      run_kubeconform: true
      run_pluto: true
